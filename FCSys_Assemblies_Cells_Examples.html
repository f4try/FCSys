<html>
<head>
<title>FCSys.Assemblies.Cells.Examples</title>
<meta name="title" content="Modelica fuel cell library">
<meta name="keywords" content="fuel cell library, FCSys, fuel cell, PEM, proton exchange membrane, polymer exchange membrane, PEMFC, Modelica, Dymola, open-source, electrochemistry">
<meta name="date" content="2014-1-22">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Examples">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="stylesheets/ModelicaDoc.css">
<link rel="shortcut icon" href="images/favicon.ico">
<script type="text/javascript" src="javascripts/analytics.js"></script>
</head>
<body>
<span itemscope itemtype="http://schema.org/SoftwareApplication">
<div class="sidebar">
  <div class="sidebarwrapper">
  <a href="index.html"><p itemprop="name" class="sidebar-title">FCSys</p></a>
  <p class="logo"><a href="index.html">
    <img itemprop="image" src="images/icon.gif" class="logo" alt="Logo" width=150>
  </a></p>

<h3>Table of Contents</h3>

<ul>
    <li><a href="FCSys_UsersGuide.html">User's Guide</a></li>
    <li><a href="FCSys_Blocks.html">Blocks</a></li>
    <li><a href="FCSys_Conditions.html">Conditions</a></li>
    <li><a href="FCSys_Assemblies.html">Assemblies</a></li>
    <li><a href="FCSys_Regions.html">Regions</a></li>
    <li><a href="FCSys_Subregions.html">Subregions</a></li>
    <li><a href="FCSys_Phases.html">Phases</a></li>
    <li><a href="FCSys_Species.html">Species</a></li>
    <li><a href="FCSys_Chemistry.html">Chemistry</a></li>
    <li><a href="FCSys_Connectors.html">Connectors</a></li>
    <li><a href="FCSys_Characteristics.html">Characteristics</a></li>
    <li><a href="FCSys_Units.html">Units</a></li>
    <li><a href="FCSys_Quantities.html">Quantities</a></li>
    <li><a href="FCSys_Utilities.html">Utilities</a></li>
    <li><a href="FCSys_Icons.html">Icons</a></li>
    </ul>

  <h3>Download</h3>
    <ul>
      <li><span itemprop="downloadUrl">Latest: <a href="https://github.com/kdavies4/FCSys/archive/v0.2.4.zip">v0.2.4</a> (2014-01-22)</span></li>
    </ul>
  </div>
</div>

<div class="document">
  <div class="documentwrapper">
    <div class="bodywrapper">
      <div class="body">

<h2><a name="FCSys.Assemblies.Cells.Examples"></a><a href="FCSys_Assemblies_Cells.html#FCSys.Assemblies.Cells">FCSys.Assemblies.Cells</a>.Examples</h2>

<b>Examples</b>

<h3>Information</h3>

Extends from <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Icons_ExamplesPackage.html#Modelica.Icons.ExamplesPackage">Modelica.Icons.ExamplesPackage</a> (Icon for packages containing runnable examples).

<h3>Package Content</h3>

<table border=1 cellspacing=0 cellpadding=2 >
<tr><th>Name</th><th>Description</th></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Exf1833e920e3f5918tionsS.png" alt="FCSys.Assemblies.Cells.Examples.TestConditions" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a>
</td><td>Fuel cell test conditions</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStand" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>
</td><td>Simulate the fuel cell under prescribed conditions</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandCycle" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandCycle">TestStandCycle</a>
</td><td>Simulate the fuel cell under prescribed conditions, with cyclical load</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSimple" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandSimple">TestStandSimple</a>
</td><td>Simulate the simple fuel cell model under prescribed conditions</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandLinearize" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandLinearize">TestStandLinearize</a>
</td><td>Wrapper for linear analysis of the fuel cell under prescribed conditions</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSegmented" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandSegmented">TestStandSegmented</a>
</td><td>Simulate the fuel cell with multiple segments in the y direction</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlow" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandFixedFlow">TestStandFixedFlow</a>
</td><td>Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate</td></tr>
<tr><td><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandS.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlowSegmented" width=20  height=20 align=top>&nbsp;<a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandFixedFlowSegmented">TestStandFixedFlowSegmented</a>
</td><td>Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate</td></tr>
</table>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Exf1833e920e3f5918tionsI.png" alt="FCSys.Assemblies.Cells.Examples.TestConditions" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestConditions"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestConditions</h2>
<b>Fuel cell test conditions</b>
<img src="images/FCSys.Assemblies.Cells.Exf1833e920e3f5918tionsD.png" alt="FCSys.Assemblies.Cells.Examples.TestConditions">

<h3>Information</h3>

<p>Some conditions are taken from the outer <a href="FCSys_Conditions.html#FCSys.Conditions.Environment">environment</a> model.  In particular,</p>
    <ol>

    <li><code>environment.T</code> is used as the initial temperature throughout the cell, the temperature at each inlet, and the exterior temperature of each end plate in the yz plane.</li>

    <li><code>environment.p</code> is used as the initial pressure throughout the cell and the pressure at each outlet.</li>

    <li><code>environment.RH</code> is used as the initial relative humidity throughout the cell.</li>

    <li><code>environment.psi_O2_dry</code> is used as the dry-gas concentration of O<sub>2</sub> at the cathode inlet.</li>

 </ol>

Extends from <a href="FCSys_Icons.html#FCSys.Icons.Record">FCSys.Icons.Record</a> (Icon for records).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<TR bgcolor="#c0c0c0"><TD colspan=4><b>Anode</b></td></tr>
<tr><td><a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">RealInputInternal</a></td><td>I_an</td><td>U.A</td><td>Equivalent current [N/T]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anRH</td><td>0.8</td><td>Relative humidity (at inlet) [1]</td></tr>
<TR bgcolor="#c0c0c0"><TD colspan=4><b>Cathode</b></td></tr>
<tr><td><a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">RealInputInternal</a></td><td>I_ca</td><td>U.A</td><td>Equivalent current [N/T]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caRH</td><td>0.5</td><td>Relative humidity (at inlet) [1]</td></tr>
</table>
<p>

<h3>Connectors</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">RealOutputInternal</a></td><td>Ndot_H2O_an</td><td>Rate of supply of H2O into the anode [N/T]</td></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">RealOutputInternal</a></td><td>Ndot_O2</td><td>Rate of supply of O2 [N/T]</td></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">RealOutputInternal</a></td><td>Ndot_H2O_ca</td><td>Rate of supply of H2O into the cathode [N/T]</td></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">RealOutputInternal</a></td><td>Ndot_N2</td><td>Rate of supply of N2 [N/T]</td></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">RealOutputInternal</a></td><td>Ndot_H2</td><td>Rate of supply of H2 [N/T]</td></tr>
<TR bgcolor="#c0c0c0"><TD colspan=3><b>Anode</b></td></tr>
<tr><td>input <a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">RealInputInternal</a></td><td>I_an</td><td>Equivalent current [N/T]</td></tr>
<TR bgcolor="#c0c0c0"><TD colspan=3><b>Cathode</b></td></tr>
<tr><td>input <a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">RealInputInternal</a></td><td>I_ca</td><td>Equivalent current [N/T]</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestConditions <font color="darkgreen">&quot;Fuel cell test conditions&quot;</font>
  <font color="blue">extends </font><a href="FCSys_Icons.html#FCSys.Icons.Record">FCSys.Icons.Record</a>;
  <font color="darkgreen">// Note:  This isn&#39;t a record because it contains time-varying variables.</font>
  <font color="blue">import </font><a href="FCSys_Characteristics_H2O.html#FCSys.Characteristics.H2O.p_sat">FCSys.Characteristics.H2O.p_sat</a>;

  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_sat=environment.p_sat/environment.p <font color="darkgreen">
    &quot;Mole fraction of H2O at saturation&quot;</font>;

  <font color="darkgreen">// Anode</font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">Connectors.RealInputInternal</a> I_an(unit=&quot;N/T&quot;) = U.A <font color="darkgreen">&quot;Equivalent current&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anRH(
    displayUnit=&quot;%&quot;,
    max=1) = 0.8 <font color="darkgreen">&quot;Relative humidity (at inlet)&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_H2O_an=anRH*psi_sat <font color="darkgreen">
    &quot;Mole fraction of H2O at the anode inlet&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_H2=1 - psi_H2O_an <font color="darkgreen">
    &quot;Mole fraction of H2 at the anode inlet&quot;</font>;

  <font color="darkgreen">// Cathode</font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealInputInternal">Connectors.RealInputInternal</a> I_ca(unit=&quot;N/T&quot;) = U.A <font color="darkgreen">&quot;Equivalent current&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caRH(
    displayUnit=&quot;%&quot;,
    max=1) = 0.5 <font color="darkgreen">&quot;Relative humidity (at inlet)&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_H2O_ca=caRH*psi_sat <font color="darkgreen">
    &quot;Mole fraction of H2O at the cathode inlet&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_O2=environment.psi_O2_dry*(1 -
      psi_H2O_ca) <font color="darkgreen">&quot;Mole fraction of O2 at the cathode inlet&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> psi_N2=(1 - environment.psi_O2_dry)*(1 -
      psi_H2O_ca) <font color="darkgreen">&quot;Mole fraction of N2 at the cathode inlet&quot;</font>;

  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> stoichH2(k=1/2);
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> anStoichH2O(k=psi_H2O_an/psi_H2);
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> stoichO2(k=1/4);
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> caStoichH2O(k=psi_H2O_ca/psi_O2);
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> stoichN2(k=psi_N2/psi_O2);

  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Ndot_H2O_an(unit=&quot;N/T&quot;) <font color="darkgreen">
    &quot;Rate of supply of H2O into the anode&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Ndot_O2(unit=&quot;N/T&quot;) <font color="darkgreen">&quot;Rate of supply of O2&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Ndot_H2O_ca(unit=&quot;N/T&quot;) <font color="darkgreen">
    &quot;Rate of supply of H2O into the cathode&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Ndot_N2(unit=&quot;N/T&quot;) <font color="darkgreen">&quot;Rate of supply of N2&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Ndot_H2(unit=&quot;N/T&quot;) <font color="darkgreen">&quot;Rate of supply of H2&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">outer </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment <font color="darkgreen">&quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(stoichH2.y, Ndot_H2);
  <font color="red">connect</font>(Ndot_H2, anStoichH2O.u);
  <font color="red">connect</font>(anStoichH2O.y, Ndot_H2O_an);
  <font color="red">connect</font>(stoichO2.y, Ndot_O2);
  <font color="red">connect</font>(Ndot_O2, caStoichH2O.u);
  <font color="red">connect</font>(caStoichH2O.y, Ndot_H2O_ca);
  <font color="red">connect</font>(stoichN2.y, Ndot_N2);
  <font color="red">connect</font>(stoichN2.u, Ndot_O2);
  <font color="red">connect</font>(I_an, stoichH2.u);
  <font color="red">connect</font>(I_ca, stoichO2.u);
<font color="blue">end </font>TestConditions;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStand" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStand"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStand</h2>
<b>Simulate the fuel cell under prescribed conditions</b>
<img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandD.png" alt="FCSys.Assemblies.Cells.Examples.TestStand">

<h3>Information</h3>

<p>Please see <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a> regarding

    how the properties of the environment are used.</p>

    <p>To run the cell with pure O<sub>2</sub> in the cathode (no N<sub>2</sub>), set <code>environment.psi_O2_dry</code> to 100%.</p>

    <p>Assumptions:</p>
    <ol>
    <li>The outer surface of each end plate has uniform temperature in the yz plane.</li>
    <li>No heat is conducted from the rest of the cell hardware.</li>
    <li>All electronic current passes through the first segment (index <code>[1, 1]</code>) of each end plate in the yz plane.</li>
    <li>There is no shear force on the fluid at either outlet.</li>
    <li>The pressure of each gas species is uniform over each inlet.</li>
    <li>The volumetric flow rates of the gas species are equal at each outlet, where the volumetric flow rate

    is approximated using the current at the outlet and the density of the gas within the last segment of the cell.</li>
    <li>The outlet pressure is applied to the gas mixture by Dalton's law (additivity of pressure).</li>
    <li>At the outlet, the liquid has the same pressure as the gas (Amagat's law).</li>
    <li>There is no thermal conduction across either outlet.</li>
    </ol>

Extends from <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Assemblies_Cells.html#FCSys.Assemblies.Cells.Cell">Cell</a></td><td>cell</td><td>redeclare Cell cell(inclN2=e&hellip;</td><td>Fuel cell</td></tr>
<tr><td><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.RampCurrent">RampCurrent</a></td><td>load</td><td>redeclare Modelica.Electrica&hellip;</td><td>Electrical load</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
<tr><td><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a></td><td>testConditions</td><td>&nbsp;</td><td>Test conditions</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStand <font color="darkgreen">&quot;Simulate the fuel cell under prescribed conditions&quot;</font>
  <font color="blue">import </font>&#39;Datae-&#39; = <a href="FCSys_Characteristics_'e-'_Graphite.html#FCSys.Characteristics.'e-'.Graphite">FCSys.Characteristics.'e-'.Graphite</a>;
  <font color="blue">import </font>DataH2 = <a href="FCSys_Characteristics_H2_Gas.html#FCSys.Characteristics.H2.Gas">FCSys.Characteristics.H2.Gas</a>;
  <font color="blue">import </font>DataH2O = <a href="FCSys_Characteristics_H2O_Gas.html#FCSys.Characteristics.H2O.Gas">FCSys.Characteristics.H2O.Gas</a>;
  <font color="blue">import </font>DataO2 = <a href="FCSys_Characteristics_O2_Gas.html#FCSys.Characteristics.O2.Gas">FCSys.Characteristics.O2.Gas</a>;
  <font color="blue">import </font>average = <a href="FCSys_Utilities_Means.html#FCSys.Utilities.Means.arithmetic">FCSys.Utilities.Means.arithmetic</a>;
  <font color="blue">extends </font><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <font color="darkgreen">// Aliases</font>
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI <font color="darkgreen">&quot;Electrical current&quot;</font>;

  <font color="darkgreen">// Auxiliary variables (for analysis)</font>
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w=load.v*U.V <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> J=zI/cell.caFP.A[Axis.x] <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> J_Apercm2=J*U.cm^2/U.A <font color="darkgreen">&quot;Current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_an_in=<font color="red">average</font>(<font color="red">average</font>(anSource.gas.H2.boundary.p +
      anSource.gas.H2O.boundary.p)) <font color="blue">if </font>environment.analysis <font color="darkgreen">
    &quot;Total pressure at the anode inlet&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_ca_in=<font color="red">average</font>(<font color="red">average</font>(caSource.gas.H2O.boundary.p +
      p_N2_in + caSource.gas.O2.boundary.p)) <font color="blue">if </font>environment.analysis <font color="darkgreen">
    &quot;Total pressure at the cathode inlet&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Pressure">Q.Pressure</a> Deltap_an=environment.p - p_an_in <font color="blue">if </font>environment.analysis <font color="darkgreen">
    &quot;Pressure difference down the anode channel&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Pressure">Q.Pressure</a> Deltap_ca=environment.p - p_ca_in <font color="blue">if </font>environment.analysis <font color="darkgreen">
    &quot;Pressure difference down the cathode channel&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> Deltaw_O2=(<font color="red">DataO2.g</font>(caSource[1, 1].gas.O2.boundary.T,
      caSource[1, 1].gas.O2.boundary.p) - cell.caCL.subregions[1, 1, 1].gas.O2.g)
      /4 <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Voltage loss due to O2 supply&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> Deltaw_H2O=(<font color="red">DataH2O.g</font>(caSource[1, 1].gas.H2O.boundary.T,
      caSource[1, 1].gas.H2O.boundary.p) - cell.caCL.subregions[1, 1, 1].gas.H2O.g)
      /2 <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Voltage loss due to H2O removal&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> Deltaw_H2=(<font color="red">DataH2.g</font>(anSource[1, 1].gas.H2.boundary.T,
      anSource[1, 1].gas.H2.boundary.p) - cell.anCL.subregions[1, 1, 1].gas.H2.g)
      /2 <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Voltage loss due to H2 supply&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> &#39;Deltaw_e-&#39;=cell.caFP.subregions[1, 1, 1].graphite.'e-'.g_boundaries[
      1, Side.p] - cell.caCL.subregions[1, 1, 1].graphite.'e-'.g + cell.anCL.subregions[
      1, 1, 1].graphite.'e-'.g - cell.anFP.subregions[1, 1, 1].graphite.'e-'.g_boundaries[
      1, Side.n] <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Voltage loss due to e- transport&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> &#39;Deltaw_H+&#39;=cell.anCL.subregions[1, 1, 1].ionomer.'H+'.g -
      cell.caCL.subregions[1, 1, 1].ionomer.'H+'.g <font color="blue">if </font>environment.analysis <font color="darkgreen">
    &quot;Voltage loss due to H+ transport&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> Deltaw_an=cell.anCL.subregions[1, 1, 1].graphite.
      'e-Transfer'.Deltag <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Anode overpotential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> Deltaw_ca=-cell.caCL.subregions[1, 1, 1].graphite.
      'e-Transfer'.Deltag <font color="blue">if </font>environment.analysis <font color="darkgreen">&quot;Cathode overpotential&quot;</font>;

  <font color="blue">replaceable </font><a href="FCSys_Assemblies_Cells.html#FCSys.Assemblies.Cells.Cell">Cell</a> cell(inclN2=environment.psi_O2_dry &lt; 1 - Modelica.Constants.eps)
    <font color="blue">constrainedby </font>FCSys.Icons.Cell <font color="darkgreen">&quot;Fuel cell&quot;</font>;

  <font color="darkgreen">// Conditions</font>
  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Sink">Conditions.ByConnector.BoundaryBus.Single.Sink</a> anBC[cell.n_y, cell.n_z](<font color="blue">each </font>
      graphite(&#39;inclC+&#39;=true, <font color="blue">redeclare </font><a href="FCSys_Conditions_ByConnector_ThermalDiffusive_Single.html#FCSys.Conditions.ByConnector.ThermalDiffusive.Single.Temperature">Conditions.ByConnector.ThermalDiffusive.Single.Temperature</a>
        &#39;C+&#39;(set(y=environment.T)))) <font color="darkgreen">
    &quot;Boundary condition for the anode end plate, except electrical&quot;</font>;

  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Source">Conditions.ByConnector.BoundaryBus.Single.Source</a> anSource[cell.anFP.n_x, cell.n_z]
    (<font color="blue">each </font>gas(
      inclH2=true,
      inclH2O=true,
      H2(materialSet(y=-testConditions.Ndot_H2), thermalSet(y=environment.T)),
      H2O(materialSet(y=-testConditions.Ndot_H2O_an), thermalSet(y=environment.T))))
    <font color="darkgreen">&quot;Source for the anode reactant stream&quot;</font>;

  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Sink">Conditions.ByConnector.BoundaryBus.Single.Sink</a> anSink[cell.anFP.n_x, cell.n_z]
    (gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Boundary_Single_Material.html#FCSys.Conditions.ByConnector.Boundary.Single.Material.current">Conditions.ByConnector.Boundary.Single.Material.current</a>,
          materialSet(y=anSink.gas.H2O.boundary.Ndot .* cell.anFP.subregions[:,
              cell.n_y, :].gas.H2O.v ./ cell.anFP.subregions[:, cell.n_y, :].gas.H2.v)),

      H2O(materialSet(y=<font color="red">fill</font>(
              environment.p,
              cell.anFP.n_x,
              cell.n_z) - anSink.gas.H2.p))), <font color="blue">each </font>liquid(inclH2O=cell.inclLiq,
        H2O(materialSet(y=environment.p)))) <font color="darkgreen">
    &quot;Sink for the anode reactant stream&quot;</font>;

  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Source">Conditions.ByConnector.BoundaryBus.Single.Source</a> caBC[cell.n_y, cell.n_z](<font color="blue">
      each </font>graphite(&#39;inclC+&#39;=true,&#39;C+&#39;(set(y=environment.T)))) <font color="darkgreen">
    &quot;Boundary condition for the cathode end plate, except electrical&quot;</font>;

  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Source">Conditions.ByConnector.BoundaryBus.Single.Source</a> caSource[cell.caFP.n_x, cell.n_z]
    (gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=cell.inclN2,
      <font color="blue">each </font>inclO2=true,
      <font color="blue">each </font>H2O(materialSet(y=-testConditions.Ndot_H2O_ca), thermalSet(y=
              environment.T)),
      N2(
        <font color="blue">each </font>materialSet(y=-testConditions.Ndot_N2),
        <font color="blue">each </font>thermalSet(y=environment.T),
        <font color="blue">redeclare </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Boundary_Single_Material.html#FCSys.Conditions.ByConnector.Boundary.Single.Material.pressure">Conditions.ByConnector.Boundary.Single.Material.pressure</a>),

      <font color="blue">each </font>O2(materialSet(y=-testConditions.Ndot_O2),thermalSet(y=environment.T))))
    <font color="darkgreen">&quot;Source for the cathode reactant stream&quot;</font>;

  <a href="FCSys_Conditions_ByConnector_BoundaryBus_Single.html#FCSys.Conditions.ByConnector.BoundaryBus.Single.Sink">Conditions.ByConnector.BoundaryBus.Single.Sink</a> caSink[cell.caFP.n_x, cell.n_z]
    (gas(
      <font color="blue">each </font>inclO2=true,
      <font color="blue">each </font>inclN2=cell.inclN2,
      <font color="blue">each </font>inclH2O=true,
      H2O(materialSet(y=<font color="red">fill</font>(
              environment.p,
              cell.caFP.n_x,
              cell.n_z) - p_N2_out - caSink.gas.O2.p)),
      N2(
        <font color="blue">redeclare </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Boundary_Single_Material.html#FCSys.Conditions.ByConnector.Boundary.Single.Material.current">Conditions.ByConnector.Boundary.Single.Material.current</a>,

        materialSet(y=caSink.gas.H2O.boundary.Ndot .* cell.caFP.subregions[:,
              cell.n_y, :].gas.H2O.v ./ cell.caFP.subregions[:, cell.n_y, :].gas.N2.v),

        <font color="blue">redeclare </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Boundary_Single_Material.html#FCSys.Conditions.ByConnector.Boundary.Single.Material.pressure">Conditions.ByConnector.Boundary.Single.Material.pressure</a>),

      O2(<font color="blue">redeclare </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Boundary_Single_Material.html#FCSys.Conditions.ByConnector.Boundary.Single.Material.current">Conditions.ByConnector.Boundary.Single.Material.current</a>,
          materialSet(y=caSink.gas.H2O.boundary.Ndot .* cell.caFP.subregions[:,
              cell.n_y, :].gas.H2O.v ./ cell.caFP.subregions[:, cell.n_y, :].gas.O2.v))),
      <font color="blue">each </font>liquid(inclH2O=cell.inclLiq, H2O(materialSet(y=environment.p)))) <font color="darkgreen">
    &quot;Sink for the cathode reactant stream&quot;</font>;

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(
    a={0,0,0},
    RH=testConditions.anRH,
    T=333.13*U.K,
    p=<font color="red">U.from_kPag</font>(48.3)) <font color="darkgreen">&quot;Environmental conditions&quot;</font>;

  <font color="blue">replaceable </font><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.RampCurrent">Modelica.Electrical.Analog.Sources.RampCurrent</a> load(
    offset=0.0001,
    startTime=180,
    I=150,
    duration=36000) <font color="blue">constrainedby </font>Modelica.Electrical.Analog.Interfaces.TwoPin <font color="darkgreen">
    &quot;Electrical load&quot;</font>;
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground">Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="FCSys_Conditions_Adapters_MSL.html#FCSys.Conditions.Adapters.MSL.Electronic">Conditions.Adapters.MSL.Electronic</a> anAdapt <font color="darkgreen">
    &quot;Interface with Modelica.Electrical on the anode side&quot;</font>;
  <a href="FCSys_Conditions_Adapters_MSL.html#FCSys.Conditions.Adapters.MSL.Electronic">Conditions.Adapters.MSL.Electronic</a> caAdapt <font color="darkgreen">
    &quot;Interface with Modelica.Electrical on the cathode side&quot;</font>;

  <a href="FCSys_Conditions.html#FCSys.Conditions.Router">Conditions.Router</a> anRouter[cell.anFP.n_x, cell.n_z] <font color="darkgreen">
    &quot;Switch to route the anode for reverse flow&quot;</font>;
  <a href="FCSys_Conditions.html#FCSys.Conditions.Router">Conditions.Router</a> caRouter[cell.anFP.n_x, cell.n_z] <font color="darkgreen">
    &quot;Switch to route the cathode for reverse flow&quot;</font>;

  <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a> testConditions(I_ca=2*zI, I_an=1.5*zI) <font color="darkgreen">&quot;Test conditions&quot;</font>;

<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealInput">Connectors.RealInput</a> p_N2_in[cell.caFP.n_x, cell.n_z](<font color="blue">each </font>unit=&quot;M/(L.T2)&quot;) <font color="darkgreen">
    &quot;Pressure of N2 at inlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealInput">Connectors.RealInput</a> p_N2_out[cell.caFP.n_x, cell.n_z](<font color="blue">each </font>unit=&quot;M/(L.T2)&quot;) <font color="darkgreen">
    &quot;Pressure of N2 at outlet&quot;</font>;

<font color="blue">equation </font>
  <font color="darkgreen">// Aliases</font>
  zI = load.i*U.A;

  <font color="darkgreen">// Nitrogen pressures (since N2 is conditionally included)</font>
  <font color="red">connect</font>(p_N2_in, caSource.gas.N2.materialOut.y) <font color="darkgreen">&quot;Not shown in diagram&quot;</font>;
  <font color="red">connect</font>(p_N2_out, caSink.gas.N2.materialOut.y) <font color="darkgreen">&quot;Not shown in diagram&quot;</font>;
  <font color="blue">if </font><font color="blue">not </font>cell.inclN2<font color="blue"> then</font>
    p_N2_in = <font color="red">zeros</font>(cell.caFP.n_x, cell.n_y);
    p_N2_out = <font color="red">zeros</font>(cell.caFP.n_x, cell.n_y);
  <font color="blue">end if</font>;

  <font color="red">connect</font>(cell.an[1, 1], anAdapt.boundary);
  <font color="red">connect</font>(cell.ca[1, 1], caAdapt.boundary);
  <font color="red">connect</font>(cell.an, anBC.boundary);
  <font color="red">connect</font>(cell.ca, caBC.boundary);
  <font color="red">connect</font>(anRouter.positive2, anSink.boundary);
  <font color="red">connect</font>(anRouter.positive1, anSource.boundary);
  <font color="red">connect</font>(cell.anPositive, anRouter.negative2);
  <font color="red">connect</font>(cell.anNegative, anRouter.negative1);
  <font color="red">connect</font>(caSink.boundary, caRouter.negative2);
  <font color="red">connect</font>(caSource.boundary, caRouter.negative1);
  <font color="red">connect</font>(caRouter.positive2, cell.caPositive);
  <font color="red">connect</font>(caRouter.positive1, cell.caNegative);
  <font color="red">connect</font>(anAdapt.pin, load.n);
  <font color="red">connect</font>(load.n, ground.p);
  <font color="red">connect</font>(caAdapt.pin, load.p);
<font color="blue">end </font>TestStand;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandCycle" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandCycle"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandCycle</h2>
<b>Simulate the fuel cell under prescribed conditions, with cyclical load</b>
<img src="images/FCSys.Assemblies.Cells.Ex677f5c4297457234CycleD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandCycle">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a> (Simulate the fuel cell under prescribed conditions).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandCycle <font color="darkgreen">
  &quot;Simulate the fuel cell under prescribed conditions, with cyclical load&quot;</font>
  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>(
    cell(
      anCL(subregions(graphite(<font color="blue">each </font>inclDL=true, &#39;e-Transfer&#39;(<font color="blue">each </font>fromI=false)),
            ionomer(H2O(<font color="blue">each </font>lambda_IC=13.53)))),
      PEM(subregions(ionomer(H2O(<font color="blue">each </font>lambda_IC=13.53)))),
      caCL(subregions(graphite(<font color="blue">each </font>inclDL=true, &#39;e-Transfer&#39;(<font color="blue">each </font>fromI=false)),
            ionomer(H2O(<font color="blue">each </font>lambda_IC=13.53))))),
    <font color="blue">redeclare </font><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SineCurrent">Modelica.Electrical.Analog.Sources.SineCurrent</a> load(
      freqHz=0.3,
      I=7,
      offset=4),
    testConditions(I_an=15*U.A, I_ca=20*U.A));

<font color="blue">end </font>TestStandCycle;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSimple" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandSimple"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandSimple</h2>
<b>Simulate the simple fuel cell model under prescribed conditions</b>
<img src="images/FCSys.Assemblies.Cells.Ex96eda012c9a93fd7impleD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSimple">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a> (Simulate the fuel cell under prescribed conditions).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>Deltaw_O2</td><td>(DataO2.g(caSource[1, 1].gas&hellip;</td><td>Voltage loss due to O2 supply [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>Deltaw_H2O</td><td>(DataH2O.g(caSource[1, 1].ga&hellip;</td><td>Voltage loss due to H2O removal [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>Deltaw_H2</td><td>(DataH2.g(anSource[1, 1].gas&hellip;</td><td>Voltage loss due to H2 supply [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>&#39;Deltaw_e-&#39;</td><td>cell.caFP.subregions[1, 1, 1&hellip;</td><td>Voltage loss due to e- transport [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>&#39;Deltaw_H+&#39;</td><td>cell.anCGDL.subregions[1, 1,&hellip;</td><td>Voltage loss due to H+ transport [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>Deltaw_an</td><td>cell.anCGDL.subregions[1, 1,&hellip;</td><td>Anode overpotential [L2.M/(N.T2)]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Potential</a></td><td>Deltaw_ca</td><td>-cell.caCGDL.subregions[1, 1&hellip;</td><td>Cathode overpotential [L2.M/(N.T2)]</td></tr>
<tr><td><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.RampCurrent">RampCurrent</a></td><td>load</td><td>redeclare Modelica.Electrica&hellip;</td><td>Electrical load</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
<tr><td><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a></td><td>testConditions</td><td>&nbsp;</td><td>Test conditions</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandSimple <font color="darkgreen">
  &quot;Simulate the simple fuel cell model under prescribed conditions&quot;</font>

  <font color="blue">import </font>DataH2 = <a href="FCSys_Characteristics_H2_Gas.html#FCSys.Characteristics.H2.Gas">FCSys.Characteristics.H2.Gas</a>;
  <font color="blue">import </font>DataH2O = <a href="FCSys_Characteristics_H2O_Gas.html#FCSys.Characteristics.H2O.Gas">FCSys.Characteristics.H2O.Gas</a>;
  <font color="blue">import </font>DataO2 = <a href="FCSys_Characteristics_O2_Gas.html#FCSys.Characteristics.O2.Gas">FCSys.Characteristics.O2.Gas</a>;

  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>(
    <font color="blue">redeclare </font><a href="FCSys_Assemblies_Cells.html#FCSys.Assemblies.Cells.SimpleCell">SimpleCell</a> cell(inclN2=environment.psi_O2_dry &lt; 1 - Modelica.Constants.eps),

    Deltaw_O2=(<font color="red">DataO2.g</font>(caSource[1, 1].gas.O2.boundary.T, caSource[1, 1].gas.O2.boundary.p)
         - cell.caCGDL.subregions[1, 1, 1].gas.O2.g)/4,
    Deltaw_H2O=(<font color="red">DataH2O.g</font>(caSource[1, 1].gas.H2O.boundary.T, caSource[1, 1].gas.H2O.boundary.p)
         - cell.caCGDL.subregions[1, 1, 1].gas.H2O.g)/2,
    Deltaw_H2=(<font color="red">DataH2.g</font>(anSource[1, 1].gas.H2.boundary.T, anSource[1, 1].gas.H2.boundary.p)
         - cell.anCGDL.subregions[1, 1, 1].gas.H2.g)/2,
    &#39;Deltaw_e-&#39;=cell.caFP.subregions[1, 1, 1].graphite.'e-'.g_boundaries[1,
        Side.p] - cell.caCGDL.subregions[1, 1, 1].graphite.'e-'.g + cell.anCGDL.subregions[
        1, 1, 1].graphite.'e-'.g - cell.anFP.subregions[1, 1, 1].graphite.'e-'.g_boundaries[
        1, Side.n],
    &#39;Deltaw_H+&#39;=cell.anCGDL.subregions[1, 1, 1].ionomer.'H+'.g - cell.caCGDL.subregions[
        1, 1, 1].ionomer.'H+'.g,
    Deltaw_an=cell.anCGDL.subregions[1, 1, 1].graphite.'e-Transfer'.Deltag,
    Deltaw_ca=-cell.caCGDL.subregions[1, 1, 1].graphite.'e-Transfer'.Deltag);

<font color="blue">end </font>TestStandSimple;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandLinearize" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandLinearize"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandLinearize</h2>
<b>Wrapper for linear analysis of the fuel cell under prescribed conditions</b>
<img src="images/FCSys.Assemblies.Cells.Ex94b6a44f0131d0f1arizeD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandLinearize">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a> (Simulate the fuel cell under prescribed conditions).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
<tr><td><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a></td><td>testConditions</td><td>&nbsp;</td><td>Test conditions</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandLinearize <font color="darkgreen">
  &quot;Wrapper for linear analysis of the fuel cell under prescribed conditions&quot;</font>

  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>(
    environment(analysis=false),
    cell(anCL(subregions(graphite(<font color="blue">each </font>inclDL=true, &#39;e-Transfer&#39;(<font color="blue">each </font>fromI=false)))),
        caCL(subregions(graphite(<font color="blue">each </font>inclDL=true, &#39;e-Transfer&#39;(<font color="blue">each </font>fromI=false))))),

    <font color="blue">redeclare </font><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SignalCurrent">Modelica.Electrical.Analog.Sources.SignalCurrent</a> load(i(
        start=50,
        stateSelect=StateSelect.always,
        fixed=true)));

  <font color="blue">output </font><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage">Modelica.SIunits.Voltage</a> w_V=load.v <font color="darkgreen">&quot;Potential in volts&quot;</font>;

<font color="blue">equation </font>
  <font color="red">der</font>(load.i) = 0 <font color="darkgreen">&quot;Current is a dummy state -- only for linear analysis.&quot;</font>;

<font color="blue">end </font>TestStandLinearize;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSegmented" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandSegmented"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandSegmented</h2>
<b>Simulate the fuel cell with multiple segments in the y direction</b>
<img src="images/FCSys.Assemblies.Cells.Ex97891dae517fb872entedD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandSegmented">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a> (Simulate the fuel cell under prescribed conditions).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.RampCurrent">RampCurrent</a></td><td>load</td><td>redeclare Modelica.Electrica&hellip;</td><td>Electrical load</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
<tr><td><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestConditions">TestConditions</a></td><td>testConditions</td><td>&nbsp;</td><td>Test conditions</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td>Integer</td><td>n_y</td><td>6</td><td>Number of segments in the y direction</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandSegmented <font color="darkgreen">
  &quot;Simulate the fuel cell with multiple segments in the y direction&quot;</font>

  <font color="blue">parameter </font>Integer n_y=6 <font color="darkgreen">&quot;Number of segments in the y direction&quot;</font>;
  <font color="blue">import </font>Modelica.Constants.inf;

  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>(cell(
      inclLiq=false,
      L_y=<font color="red">fill</font>(8*U.cm/n_y, n_y),
      anGDL(epsilon=0.45),
      caGDL(epsilon=0.45)));

<font color="blue">end </font>TestStandSegmented;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlow" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandFixedFlow"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandFixedFlow</h2>
<b>Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate</b>
<img src="images/FCSys.Assemblies.Cells.Ex3c0da8de817bcc46dFlowD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlow">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a> (Simulate the fuel cell under prescribed conditions).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Assemblies_Cells.html#FCSys.Assemblies.Cells.Cell">Cell</a></td><td>cell</td><td>redeclare Cell cell(inclN2=e&hellip;</td><td>Fuel cell</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandFixedFlow <font color="darkgreen">
  &quot;Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate&quot;</font>
  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStand">TestStand</a>(testConditions(I_an=anFlowSet.y, I_ca=caFlowSet.y), load(
        startTime=120));
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> anFlowSet(
    height=120*U.A,
    duration=120,
    offset=0.1*U.mA,
    startTime=60) <font color="darkgreen">&quot;Specify the equivalent current of the anode supplies&quot;</font>;
  <a href="file:///C:/Program Files (x86)/Dymola 2014/Modelica/Library/Modelica 3.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> caFlowSet(
    height=160*U.A,
    duration=120,
    offset=0.1*U.mA,
    startTime=60) <font color="darkgreen">&quot;Specify the equivalent current of the cathode supplies&quot;</font>;
<font color="blue">end </font>TestStandFixedFlow;
</pre>
<hr>

<h2><img src="images/FCSys.Assemblies.Cells.Ex964208b8a43908c9StandI.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlowSegmented" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Assemblies.Cells.Examples.TestStandFixedFlowSegmented"></a><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples">FCSys.Assemblies.Cells.Examples</a>.TestStandFixedFlowSegmented</h2>
<b>Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate</b>
<img src="images/FCSys.Assemblies.Cells.Ex3c0da8de817bcc46dFlowD.png" alt="FCSys.Assemblies.Cells.Examples.TestStandFixedFlowSegmented">

<h3>Information</h3>

Extends from <a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandFixedFlow">TestStandFixedFlow</a> (Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>anRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the anode for reverse flow</td></tr>
<tr><td><a href="FCSys_Conditions.html#FCSys.Conditions.Router">Router</a></td><td>caRouter[cell.anFP.n_x, cell.n_z]</td><td>&nbsp;</td><td>Switch to route the cathode for reverse flow</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td>Integer</td><td>n_y</td><td>6</td><td>Number of segments in the y direction</td></tr>
</table>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestStandFixedFlowSegmented <font color="darkgreen">
  &quot;Simulate the fuel cell with multiple segments in the y direction, with fixed flow rate&quot;</font>
  <font color="blue">parameter </font>Integer n_y=6 <font color="darkgreen">&quot;Number of segments in the y direction&quot;</font>;

  <font color="blue">extends </font><a href="FCSys_Assemblies_Cells_Examples.html#FCSys.Assemblies.Cells.Examples.TestStandFixedFlow">TestStandFixedFlow</a>(
    cell(
      inclLiq=false,
      L_y=<font color="red">fill</font>(8*U.cm/n_y, n_y),
      anGDL(epsilon=0.45),
      caGDL(epsilon=0.45)),
    testConditions(I_an=anFlowSet.y, I_ca=caFlowSet.y),
    caFlowSet(startTime=0),
    anFlowSet(startTime=0),
    load(startTime=0));

<font color="blue">end </font>TestStandFixedFlowSegmented;
</pre>
      </div>
    </div>
  </div>
</div>
<div class="footer">
  &copy; Copyright 2007&ndash;2014, Kevin Davies, Hawaii Natural Energy Institute. Last updated Wed Jan 22 14:50:19 2014.
</div>
</span></body></html>
